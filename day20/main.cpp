#include <iostream>
#include <vector>
#include <string>
#include <utility>
#include <sstream>
#include <algorithm>
#include <bitset>
#include <set>
#include <fstream>

char const* pDummy = R"(Hello :))";
extern char const* pTest;
extern char const* pData;

using Result = size_t;
using Answers = std::vector<std::pair<std::string,Result>>;

using Coordinate = int;
using Position = std::vector<int>;
struct Image {
  std::set<Position> pixels{};
  std::pair<Position,Position> frame{};
};

struct Model {
  std::bitset<512> algorithm{};
  Image image{};
};

Model parse(auto& in) {
    Model result{};
    std::string line{};
    int state{0};
    Coordinate x{0},y{0};
    Position ul{0,0},lr{0,0};
    while (in >> line) {
      // std::cout << "\nin:" << line;
      if (line.size()>0) {
        switch (state) {
          case 0: {
            std::string bs{};
            std::transform(line.begin(),line.end(),std::back_inserter(bs),[](char ch) {return (ch=='#')?'1':'0';});
            result.algorithm = std::bitset<512>(bs);
            state=1;
          }
          break;
          case 1: {
            // x horizontal +right, y vertical + down
            for (char ch : line) {
              if (ch=='#') {
                // std::cout << "\n{" << x << "," << y << "} " << ch;
                result.image.pixels.insert(Position{x,y});
                lr[0] = std::max(lr[0],x);
                lr[1] = std::max(lr[1],y);
              }
              ++x;
            }
            x=0;
            ++y;
          }
          break;
        }
      }
    }
    result.image.frame.first = ul;
    result.image.frame.second = lr;
    return result;
}

void print_image(Image const& image) {
  // Print image inside area upper-left corner to lower right corner
  for (int y = image.frame.first.at(1);y< image.frame.second.at(1);y++) {
    std::cout << "\n";
    for (int x = image.frame.first.at(0);x < image.frame.second.at(0);x++) {
      if (image.pixels.find(Position{x,y}) != image.pixels.end()) {
        std::cout << "#";
      }
      else std::cout << '.';
    }
  }
}

namespace part1 {
  Result solve_for(char const* pData) {
      Result result{};
      std::stringstream in{ pData };
      auto puzzle_model = parse(in);
      print_image(puzzle_model.image);
      return result;
  }
}

namespace part2 {
  Result solve_for(char const* pData) {
      Result result{};
      std::stringstream in{ pData };
      auto data_model = parse(in);
      return result;
  }
}

int main(int argc, char *argv[])
{
  Answers answers{};
  answers.push_back({"Part 1     ",part1::solve_for(pTest)});
  answers.push_back({"Part 1     ",part1::solve_for(pData)});
  // answers.push_back({"Part 2 Test",part2::solve_for(pTest)});
  // answers.push_back({"Part 2     ",part2::solve_for(pData)});
  for (auto const& answer : answers) {
    std::cout << "\nanswer[" << answer.first << "] " << answer.second;
  }
  // std::cout << "\nPress <enter>...";
  // std::cin.get();
  std::cout << "\n";
  return 0;
}

char const* pTest = R"(..#.#..#####.#.#.#.###.##.....###.##.#..###.####..#####..#....#..#..##..###..######.###...####..#..#####..##..#.#####...##.#.#..#.##..#.#......#.###.######.###.####...#.##.##..#..#..#####.....#.#....###..#.##......#.....#..#..#..##..#...##.######.####.####.#.#...#.......#..#.#.#...####.##.#......#..#...##.#.##..#...##.#.##..###.#......#.#.......#.#.#.####.###.##...#.....####.#..#..#.##.#....##..#.####....##...##..#...#......#.#.......#.......##..####..#...#.#.#...##..#.#..###..#####........#..####......#..#

#..#.
#....
##..#
..#..
..###)";
char const* pData = R"(##...###...##.#..###.#...#....#..###.##.###...###.##.##.####.#######..######....#.###.##....#.##...#..........#####..##..#..##...##....####.###..#..####.##.##.#....#.##.#.#.#.#..##.##.#...##..##...#.#...#...#..#.#...#.##...#..######.#.##..#.#.#...##.###..########...........#.#.###.#.#..##...#..#..###..#..##.#.#...##..##..###..#####...#.####....#.###....###.##.##...##.#..#.#..####....#..##...##.#####.###.###.###.....##...#.#..#.######.##.##.......###...#.....#...##..#..#.###.#..#..########.##......###..##.#.

###.###...##..#.......#...#...#.#.#.#...#.##.#...##...###..#..#.#.#.#...#..#.#...#...#.##.#.#######.
#...##....#......######.##.#####.#...#.#..#####....##.##...#...###.#.###.##.#..#....#.####...#.....#
.#.#..#.###.##.###....##......##.##.###.#...###.##...###...#.###....##.##...##...##....#..##.###.#.#
##.###.#.#####.#######..#...#.#...#.###....#..#.#......####..##.###....#..#....#.#..#.#.#.##...##.#.
#...........#...#..#..###...###.#..........#.###..#....##...#..#.##..#....###.####..###..#.###.....#
.###.........##..##....#...##...#.....###.#....#.##.#.###.##....#.#.....##.###.....###.###....##.#..
#######.#...#...#..####...#.#####.#...#..#.##......#..##...####.##.###....#.###.#.#.###.####.#..#...
.####..######.#...#.#......#.####..#...#####....#...#.###...........##....##..####..#...###....#.#.#
#.#..##.###.###.#..##..#..###..#.#.#.#...#..##..#####..#.##.....##.##.##..#.##...##.##......#..####.
.#####..#.#.###....#.##.##.####.#...##..#...#.#.#.##.##...##...#.#..#.....#.#.##.##.###.#.........##
.####...#.####...#####..##.####.#.#####...##..###.###.##.#....#.#.#.....###.#.#...#....#.##.#....###
.###.##.#.##..#...#..#.#.###..#.#.##....####..##.###.####........##..###.#..####.#..#####...####.###
##.####..##.##.#.#.####..#...#.....#######...###..#####.#...#.#####.#.##..##.#.##.#...###....#.#...#
.####.....#....#...#.#.#.#.#.##...#..#.#####.#..#.#..##.####.###..#..##...#..##.#..#.#..##.....####.
...##.#...#..###.#####..##.###..#.#.#.#...###..#####.#.#...#..######..#..###########......#...#.##.#
#.#.#####..####..#.####..###......##.#.####..#.##.#..#.#.#...#.#..#...##.##....##.#.#..##..##..####.
#...#######.#..#..####.#..#...#.#......#.##.##..####.##..#..##.##.###.#..###..#...#.##.##.#..#.##.#.
.###..#.##.........#.#..###.####.##.##.#..#######..#.##.#.#...#..#....##.#..##..#.#.###.#..##....#.#
##..###...#...##.##..##.#..##.###.##.#.##########.######.##.##.##.##..#......#.####.......#.#..#..#.
..#.##.#..##...#.....##.##..##.#.#..####.#####....#.#####.........##.#..##.#..##...#...###..#.###...
##..#.#.....#.##..##...##...#......##...#.#..##..##..##....#..#.###...###.###.#.#.#....###.##..##..#
.####..##.###...#.....#.#.###..####..#...##.##.##.#.###..##.##.###....#.##.#####.##.#.##.####..###.#
#.###.##..#.#####...##.#.#.####.##.###.##..##..##.##.###.####.....##.###....#...#.##.#######.##.#.##
..#....#...#....##.##..###.#.####.#.#...##.##....#....####.##..#...##.###..#.....#.....####.###.#.##
##.#...##..##...#.#...##.#.#.#..#.##.##.#.#..#.###.###..#...##...#.####...######.#..#......#...##..#
###.#....#.#...#.#.#..#####..#....#...####.#....#...##.#.##...##.##.#.#####.#..##.#...#...#.#..#.#.#
##...#.#..#.##.#.##..#.#.##.###.##..#.###.##..##..##.#..#....#.####.#..#......########.#.###.#.#...#
##.....#..##...##.##.####.#...##..#.##...#.#.##..#..####..##....######.##...##.####.##..#.##...###..
..###.#.##.#.##.#.#......#.#####..#.#.####.###...##..##..##....#.#...#.##.##..###....#.....#####..##
..#......#.#.#....#.#####.##.##.###..##...##.##.#..##.##....##..##....###....#..##.####...#.#.#.##..
.#.....##.#...#.#..##...#.##..#....#..###...#####..#....#.##..#..##.##.####..#.#...##.##...##..##..#
##.##..###...####....#.#####..#.###...#.###.....######..##.##.##..#.#.#..#..#######..#.#..#.#.#....#
###.##.#...#...###.##.#.#.#..#.####.....#..#.##.##...#.####..##...#.##.#...#...###.#.#...#.#.##..##.
######..#...###..#.....##...#..#######.....#...#.#...##.#..#.###.###.#.#.#...##..###.#.###..###.#.#.
#.#.##.#.#.#####.#######.#..##..#####.#.###..###.#.#...#...#.#....##.###.#..#...#####...###..#...#.#
##.#.....##...##.###..#####.####...##.#.#.#........##.######.#....#.#..#######.###..##...#.#..##.#..
######..#..##...#.##.###...####.#####......#..#####.#.#..#.##.#####.#..#...#.#.#...........###..#.#.
.#####.#####...##.#.#.##.#.#.###.#.##.##.##..###..#..#.##.##.......##...##.#..#.#.#.###.#...#..#....
##..#.######....##.###.##...##..#.#.##..#.##...#.###..#.#....#.....##...###.#.###..######..###.##.#.
.#.#.#.#...###.##....###..#.#.#.#.....#.#.#.####.####.###..##...#.#....#.#....##..#.##.##..##.####..
##.##..#.#....#...#.##.##.....#...#.####.####..#..###.####.#...#.###.....#..#.####.#.......#.#...###
#..#..####..#.#..##..#########...#..########..#..######..#..##..###.#####.#..#.#####.#......#..###..
...#.#.....#....#####..##.##.#.##.###.##.#...#...####....#...####....#####.##...#.##...##.#.#..####.
...#...##..#..#######..#######..#..##.#.##...##.##.#..#..######.#.#.##.###.#.###.####..####.####..#.
###.##.#.##..####.#..#.#...###...#..###..##.####...###...#...#####..###..##.#..##...####..#.##.###.#
..##.#.#.#.#..#..#.#...#.#.#..####...#.#.###..##..##..#..#.#.##...##.##.###.##..#.#.#....##...#.##.#
.....#.#..##....#.#..#.##..#.##...#.#...##..#..####.##.#.##.##...#....#.#.####.###...######.##.....#
#.#.#..#......##.......#...#.#...####..######.##.##..#.###.##..##.#...#.###.....###.#....##.#.#..#.#
#..#####....###..####..##.##.#..#.##.##.#..####.##....#...###.##..####..##..#####......#....#.##...#
#..#.#.#.#.#.##..#.##.#.#....###.#....#.#.######.##.#.......#.######..#...#........#..##.##.##.#####
.#####..##.###.##...##...##.##.#...#..#.###..##.##....##.##..#.#..#.##..#.##..........#...#.#..##..#
#...###.#####..###..#.#######..####..##...#.###.###.###..#.##..###....##.##..#...####.####.#.#...#..
##.#....####.#.#.#.#.#..##..##..##..#....#..#...#.#...##.#.###.#.####.#####....#..##..##.#..#.#.##..
.##...####.##.#.#.#.#..#####....##..##..#..####...##..#...#.#.......#.#.#...#.........##..##.##.#...
..#...#..#####.##.......#####.####..#####...#..##.##..#.#...##..#..#.#.....#.##.##.##....##..#.#####
##....#..##.####.#.......#.##.#.#.#...#.##.#.#....########.###...#.######.###.........##.#........##
#...##.##...#..#..##.#.#...#########.##...##.#.####.####......##.#..#.#.#.#..##........#..##.#######
#.###.#..#.##.#.##.#######.##.##.##..###...#.#.....#.##.#.##.###..##..##..##.#.....##.#...#.....##..
.##.#.##..##..##..###.....#...###....#..#..#....#...#.#....###.#.###..#.#####.###..#.##..###..#..#..
.##.##...#.##..#...##..####...###.####.##.#.####..#....####.#..##..#....##...#......#...####.#.#...#
#..#..####..##...#.####...##....##..####....#.#..####.#.#.##...##.#######.###.##.#.....#.####.#.#..#
....#..##.#.#.#.##.#....##..#..###...##....#..###..#########...###.#.#.#.##..##.....###.####.#.....#
.....####.###.#.####..####.#..##....#..#...#..#...###....#.#.#..###.#.###...##..#....#.#.#.#...###..
###.#.#.#..#.##..#.#.#.#..#####.#.####.#..##.....##.#.##.##.#.##..#.##..#..#.#.#..##..##.#......####
.###..####...#..#.#.##...##.#.#..#....##..#.....#.#.#.#..#.#...#...###.#..#.#.....#...#####...###...
#..##.#.###.#..#.#...#....###.###.#.##.##.##.##..##.#..#.#.###.##..#.#....#..##.####.##.####.#.#..#.
#..##.#....#..#.###...#.##.#..#.#...#.#####..#.###......#.#..#.##..###.##.#..#.......########.###.#.
###.##...#..#..#.##.#..#......#.....#####.###....##.......##...####..##.##..#.##....#..#.###.##....#
...#....#.###.##..#..###...##.###..##..#..#...#...####..#.###.#.#..#####.#.####..###..#.###..##..#..
##.#..#..####.#..#.#.#.#.###...###.##..##.##.#.##.#...##..#.#.####..####..##.##.######.#...#.####...
.#....##.##.##.....###...##.##.#.#.#.###...##.##..#.##.###.....##..######....#.#...#.#..####....#.##
.#.######.#.#...###.#.####.####...###.###..#.#...#.....##.....##...###.##....##.####..##.#.##.....#.
#..##.##.#..##.#......###...####..#..###...##.#####.#....#.##..#.#.##.#.#.#....###..##.##.#.###.###.
####.#..#.##..##.#..#.#.##..######..##.#..#..##.#######.####.#.#..####.....##....###.###.###.#..#..#
#..#.###.##..###.##.#..##.##..####.#.....#.....#..#.#.....#......#..#.##..#.#.#......#..##.###.#..##
......#.#.###.#.##..#...#.###.#..##.###.#...###.##..#..#####.##..##.##.##.###.##.######.#.##...#.###
.....#..###.....#.#.##........#.#...###.#.###.###..#.#.##....#..##.#......#.#..#....####.#.#.#..####
##..#....#.##...#####....#.####.##.#.##..###.##...#.#....#..###.#..#..##.#....#..##.#.##..###....#..
....###..##...#.##..#.#..####.##.##..#.....##.##..###...##.#...#.#####....#..###.#..#.#.##.#.####..#
..#..#.....#..####.......#.#..##..#..##########...##..###......#.....#....##..#..##...#....#.#.#..#.
###.#.#....##..##.###...#.#.....#.......##.###.###...........####...##..##.#...####...#.###..#..##.#
.##...#..###...##.#####.####..#####..##.....##..#.#...##.#...##.#.#.#.#...###..#...#..##..#.#..##.#.
.##....#...##..#.##..####.#....#..##.##..#....#######.####...#.#..#...####..#..###.###..##.###.#.#.#
.........##...#.####...#....#...##.###############.#..#.##..####.#.#.#.....##..#.###..###...#..####.
#...####..####.##...####.#.#...####.####..###..#.....#.###.#.##...#...####.#.#.#....##.#...#..##....
#.#.....##.#.####......#.#.##.##.######..#..###...#.....#..#...##.#..##.#..#...#####.###..#.####.###
.##.###.#..##....##.#.#.....##....##..#.#####.######.###.#####.#..#..#####..##....#.###.#####.#####.
#.#...#...#####.###.#....#.#.###.....#.....##...#...#.#....##.##..###..##.####.#....##..#######.###.
....#...###.###.##.##.....#..#.##.##..#..##...#..#....###......#########.#...#.##..#.###.##..##.##.#
#..##...####.###....##..#.#.#.#..####..#.###.#.#####.##.##.####.##....##..#...##.#...#.####....#####
#..#...###..##.####....##..#.#..#.##.####.###..#..###.##..####.##..##.###.####.##......#..#.###...##
#.#....###.#..#.....#..#.##..###.#...#.....#.###..####.##....##.#..##...###.#####....#.##....#..##.#
..#..#..##....#...######.#.##...#......####..#.#....#.##.##..##..#..#..#..##...##..##.#####....#..##
##.#..###.##..#####..##.##.#...#..##.#.#....###.#.###.#......#.#.#....######..###.###.##.####.#.###.
...##.#...####.###.....#########.....#.###..##..........##..####.###.#.##.#.#..##....#...##.###.###.
.######..###..##...#.####.....#.###.####.....####.#.##.#.##.###.#....##.#..#.#.#..##.###...#.#.###..
#..###.#..##.#.##..###..##..#########..#.#......#..##.#..#.##..###.###.#...#....#....###..#.....#..#
##..##.###......#.#....#..##.#...##...###.###.######..#....####.#.####.#..###..###.####.##.##....##.
####.#...#...#####..#...##....####..##.#.#....#####.##......#.#.#...#...#...#..##..#.#...#.#...##.#.
###.#.##....##.#####.###...##..##..#####..#.##..#......#.##...#.#....###...##.##..###...#..#..##.##.)";
